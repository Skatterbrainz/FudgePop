{
	"configuration": {
		"version": "2.0.0",
		"comment": "FudgePop - sample windows device configuration control file",
		"control": {
			"enabled": true,
			"exclude": "",
			"comment": "kill switch",
			"version": "2025.12.13.001"
		},
		"priority": {
			"order": "files,folders,modules,deployments,removals,upgrades,appxremovals,registry,services,shortcuts,opapps,permissions,updates"
		},
		"collections": {
			"comment": "computer groups",
			"collection": [
				{
					"name": "developers",
					"members": "w11-rmm-dave",
					"comment": "Developer Computers"
				},
				{
					"name": "engineers",
					"members": "computer3,computer4",
					"comment": "Engineers and Designers workstations"
				},
				{
					"name": "general",
					"members": "computer5,computer6",
					"comment": "General user computers"
				}
			]
		},
		"winget_installs": {
			"comment": "WinGet packages to install or upgrade",
			"deployment": [
				{
					"device": "all",
					"user": "all",
					"enabled": true,
					"when": "now",
					"update": false,
					"packages": "7zip.7zip,google.chrome,notepad++.notepad++,microsoft.office,Microsoft.Sysinternals.ZoomIt"
				},
				{
					"collection": "developers",
					"enabled": true,
					"when": "now",
					"packages": "Microsoft.VisualStudioCode,git.git,Microsoft.Sysinternals.ProcessExplorer,Microsoft.Sysinternals.ProcessMonitor,Microsoft.Sysinternals.AutoRuns",
					"update": false
				}
			]
		},
		"choco_installs": {
			"comment": "Chocolatey packages to install or upgrade",
			"deployment": [
				{
					"device": "all",
					"user": "all",
					"enabled": false,
					"when": "now",
					"update": false,
					"packages": "office365business,7zip,googlechrome,notepadplusplus,zoomIt"
				},
				{
					"collection": "developers",
					"enabled": false,
					"when": "now",
					"packages": "vscode,git,postman,processexplorer,processmonitor,autoruns",
					"update": false
				}
			]
		},
		"removals": {
			"comment": "WinGet packages to remove",
			"removal": [
				{
					"device": "all",
					"user": "all",
					"enabled": true,
					"when": "now",
					"packages": "News,Movies & TV,Mail and Calendar,Copilot,Cortana,Windows Maps,Microsoft Photos,Microsoft To Do,Microsoft People,MSN Weather"
				},
				{
					"collection": "developers",
					"enabled": true,
					"when": "now",
					"packages": "Feedback Hub,Windows Camera"
				}
			]
		},
		"appxremovals": {
			"comment": "AppX store apps to remove",
			"appxremoval": [
				{
					"device": "w11-rmm-dave",
					"user": "all",
					"enabled": false,
					"when": "now",
					"comment": "",
					"apps": ""
				}
			]
		},
		"folders": {
			"comment": "folders to create or manage",
			"folder": [
				{
					"device": "all",
					"enabled": true,
					"action": "create",
					"path": "c:\\temp",
					"comment": ""
				},
				{
					"device": "all",
					"enabled": false,
					"action": "empty",
					"path": "c:\\windows\\temp",
					"comment": ""
				},
				{
					"device": "computer1",
					"enabled": false,
					"action": "delete",
					"path": "c:\\TestFolder",
					"comment": ""
				},
				{
					"collection": "developers",
					"enabled": false,
					"action": "create",
					"path": "c:\\gitrepos",
					"comment": ""
				}
			]
		},
		"files": {
			"comment": "files to create or manage",
			"file": [
				{
					"collection": "developers",
					"enabled": false,
					"action": "rename",
					"source": "c:\\TestFolder\\test1.txt",
					"target": "c:\\TestFolder\\test100.txt"
				},
				{
					"collection": "developers",
					"enabled": false,
					"action": "move",
					"source": "c:\\TestFolder\\test2.txt",
					"target": "c:\\TestFolder\\test2.txt"
				},
				{
					"collection": "developers",
					"enabled": false,
					"action": "copy",
					"source": "\\\\server123\\data\\test123.txt",
					"target": "c:\\TestFolder\\test123.txt"
				},
				{
					"collection": "developers",
					"enabled": false,
					"action": "delete",
					"source": "c:\\TestFolder\\test3.txt"
				},
				{
					"collection": "developers",
					"enabled": false,
					"action": "download",
					"source": "https://www.7-zip.org/a/7z2501-x64.exe",
					"target": "c:\\windows\\temp\\"
				}
			]
		},
		"registry": {
			"comment": "registry keys and values to create or manage",
			"reg": [
				{
					"device": "all",
					"enabled": true,
					"action": "create",
					"path": "HKLM:\\software\\fudgepop",
					"value": "CustomValue",
					"data": "$(Get-Date)",
					"type": "string"
				},
				{
					"device": "all",
					"enabled": true,
					"action": "create",
					"path": "HKLM:\\software\\fudgepop",
					"value": "ControlVersion",
					"data": "$controlversion",
					"type": "string"
				}
			]
		},
		"modules": {
			"comment": "powershell modules",
			"module": [
				{
					"collection": "developers",
					"enabled": true,
					"name": "importexcel",
					"version": "latest",
					"when": "now",
					"comment": "Excel Workbook Functions"
				},
				{
					"collection": "developers",
					"enabled": true,
					"name": "psdates",
					"version": "latest",
					"when": "now",
					"comment": "Date Functions"
				},
				{
					"collection": "developers",
					"enabled": true,
					"name": "pswindowsupdate",
					"version": "latest",
					"when": "now",
					"comment": "Windows Update Functions"
				},
				{
					"collection": "developers",
					"enabled": false,
					"name": "pnp.powershell",
					"version": "1.2.0",
					"when": "now",
					"comment": "SharePoint Online powershell"
				}
			]
		},
		"services": {
			"comment": "Windows services to configure or manage",
			"service": [
				{
					"device": "all",
					"enabled": false,
					"name": "RemoteRegistry",
					"action": "modify",
					"config": "startup=automatic"
				},
				{
					"device": "computer1",
					"enabled": false,
					"name": "PcaSvc",
					"action": "restart",
					"config": ""
				},
				{
					"collection": "developers",
					"enabled": false,
					"name": "Beep",
					"action": "modify",
					"config": "startup=disabled"
				}
			]
		},
		"shortcuts": {
			"comment": "shortcuts to create, modify or remove. for path ref: https://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx",
			"shortcut": [
				{
					"collection": "developers",
					"enabled": true,
					"action": "create",
					"name": "M365",
					"type": "url",
					"target": "http://m365.cloud.microsoft/",
					"path": "commondesktop",
					"force": true
				},
				{
					"device": "all",
					"enabled": false,
					"action": "create",
					"name": "Internet Explorer",
					"type": "lnk",
					"target": "c:\\program files\\internet explorer\\iexplore.exe",
					"path": "commondesktop",
					"force": true,
					"description": "Internet Explorer",
					"windowstyle": "normal",
					"args": "",
					"workingpath": ""
				}
			]
		},
		"opapps": {
			"comment": "on prem win32 application deployments",
			"opapp": [
				{
					"collection": "developers",
					"enabled": false,
					"action": "install",
					"name": "Contoso App 1.23",
					"when": "now",
					"run": "msiexec /i \\\\server123\\apps\\contoso\\app123.msi /q /norestart",
					"platforms": "win7x64,win10x64",
					"restart": false,
					"detect": "capp123"
				}
			]
		},
		"detectionrules": {
			"comment": "used for verifying win32 app installs",
			"detectionrule": [
				{
					"name": "capp123",
					"enabled": false,
					"app": "Contoso App 1.23",
					"path": "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{XX0ABD92-53DF-44EC-C647-110117141167}",
					"value": ""
				},
				{
					"name": "RDCMan27",
					"enabled": false,
					"app": "RDC Manager 2.7",
					"path": "HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{0240359E-6A4C-4884-9E94-B397A02D893C}",
					"value": ""
				}
			]
		},
		"permissions": {
			"comment": "configure security permissions on local resources",
			"permission": [
				{
					"collection": "developers",
					"enabled": false,
					"path": "c:\\gitrepos",
					"principals": "users",
					"rights": "modify",
					"comment": "to maintain git repos"
				}
			]
		},
		"groups": {
			"comment": "local security groups",
			"group": [
				{
					"collection": "developers",
					"enabled": false,
					"groupname": "Administrators",
					"action": "addmember",
					"member": "jdoe"
				}
			]
		},
		"updates": {
			"comment": "force microsoft updates download and install cycle",
			"update": [
				{
					"device": "all",
					"enabled": false,
					"when": "daily"
				}
			]
		}
	}
}